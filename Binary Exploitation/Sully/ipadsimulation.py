#!/usr/bin/python
from scapy.all import *

conf.iface="eth0"

DSTIP="74.125.73.147" # Specify your target where NAC will observe it
SPORT=int(RandNum(1024,65535))

ip=IP(dst=DSTIP, flags="DF", ttl=64)
tcpopt = [ ("MSS",1460), ("NOP",None), ("WScale",2), ("NOP",None),
    ("NOP",None), ("Timestamp",(123,0)), ("SAckOK",""), ("EOL",None) ]
SYN=TCP(sport=SPORT, dport=80, flags="S", seq=10, window=0xffff, options=tcpopt)
SYNACK=sr1(ip/SYN)       # Send the packet and record the response as SYNACK

my_ack = SYNACK.seq + 1  # Use the SYN/ACK response to get initial seq. number
ACK=TCP(sport=SPORT, dport=80, flags="A", seq=11, ack=my_ack, window=0xffff)
send(ip/ACK)

data = "GET / HTTP/1.1\r\nHost: " + DSTIP + "\r\nUser-Agent: Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\r\n\r\n"
PUSH=TCP(sport=SPORT,dport=80, flags="PA", seq=12, ack=my_ack, window=0xffff)
resp = sr1(ip/PUSH/data)

print resp.summary()

RST=TCP(sport=SPORT,dport=80, flags="R", seq=13, ack=my_ack, window=0xffff)
send(ip/RST)